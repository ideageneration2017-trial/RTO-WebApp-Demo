<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fees & Payments ‚Äî Student Portal</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
:root{
  --sidebar-bg: #eaf6fb;
  --accent: #e53935;
  --brand-1: #0f766e;
  --card-bg: #ffffff;
  --muted: #6b7280;
  --shadow: 0 6px 20px rgba(18,38,63,0.08);
  --radius: 12px;
  --max-width: 1200px;
}

/* base */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:"Inter",system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  background:#f7fafc;
  color:#111827;
  line-height:1.3;
}
a{color:inherit;text-decoration:none}
.app{display:flex;min-height:100vh;gap:24px}

/* Sidebar (exact same structure as your existing screens) */
.sidebar{
  width:260px;
  background:var(--sidebar-bg);
  padding:20px 18px;
  border-right:1px solid rgba(15,23,42,0.03);
  display:flex;
  flex-direction:column;
  gap:16px;
  position:fixed;
  left:0;
  top:0;
  bottom:0;
}
.nav a{
  display:flex;
  gap:12px;
  align-items:center;
  padding:10px 10px;
  border-radius:8px;
  color: #0f1724;
  font-size:14px;
  font-weight:500;
}
.nav a:hover{ background: rgba(15,23,42,0.03) }
.nav .group-title {
  color: var(--muted);
  font-size: 12px;
  padding: 10px 6px 2px 6px;
  font-weight: 600;
  text-transform: uppercase;
}

/* Main content area & topbar (same pattern) */
.main{
  flex:1;
  padding:28px;
  max-width: calc(var(--max-width) - 40px);
  margin: 0 auto;
  width:100%;
  margin-left: 260px; /* account for fixed sidebar */
}
.topbar{
  display:flex;
  justify-content:flex-end;
  align-items:center;
  gap:10px;
  margin-bottom:14px;
}
.profile-avatar{ width:40px;height:40px;border-radius:50%;object-fit:cover;border:2px solid white;box-shadow:0 4px 12px rgba(2,6,23,0.08)}
.profile-container{position:relative;display:flex;align-items:center;gap:10px;cursor:pointer;user-select:none}
/* Profile dropdown styles added here */
#profile-dropdown-menu{
  position:absolute;right:0;margin-top:12px;width:260px;
  background:#fff;border:1px solid #e5e7eb;border-radius:8px;
  box-shadow:0 10px 30px rgba(2,6,23,0.12);z-index:50;padding-bottom:8px;
}
#profile-dropdown-menu.hidden{display:none}
#dropdown-arrow{color:#9ca3af;transition:transform .18s ease}
/* End of added styles */

/* Page header */
.page-header{ padding-bottom:14px; }
.page-header h1{margin:0;font-size:20px;font-weight:700}
.page-header p{margin:6px 0 0;color:var(--muted);font-size:13px}

/* Layout for Fees page */
.fees-grid{
  display:grid;
  grid-template-columns: 1fr 360px;
  gap:18px;
}
@media (max-width:980px){
  .main{ padding:16px; margin-left: 0; } /* allow full width on mobile */
  .fees-grid{ grid-template-columns: 1fr; }
}

/* Summary card */
.summary{
  background:var(--card-bg);
  border-radius:var(--radius);
  padding:16px;
  box-shadow:var(--shadow);
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  margin-bottom:12px;
}
.summary .left{ display:flex; flex-direction:column; gap:6px }
.balance{ font-size:22px; font-weight:700; color:#0f1724 }
.next-due{ color:var(--muted); font-size:13px }

/* Invoice list */
.invoices{
  background:var(--card-bg);
  border-radius:var(--radius);
  padding:12px;
  box-shadow:var(--shadow);
}
.invoices h3{ margin:0 0 12px; font-size:15px }
.filter-row{ display:flex; gap:8px; align-items:center; margin-bottom:12px; flex-wrap:wrap }
.input{ padding:8px 12px; border-radius:8px; border:1px solid #e6eef1; background:#fff; min-width:160px }
.invoices-list{ display:flex; flex-direction:column; gap:10px; max-height:520px; overflow:auto; padding-right:4px }

/* invoice card */
.invoice{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  padding:12px;
  background: #fbfdfe;
  border-radius:10px;
  border-left:4px solid transparent;
}
.invoice.overdue{ border-left-color: var(--accent); background:#fff5f5 }
.invoice.due{ border-left-color: #f59e0b; }
.invoice.paid{ border-left-color: #10b981; background:#f6fffa }
.invoice .meta{ color:var(--muted); font-size:13px }
.invoice .amount{ font-weight:700; font-size:16px }

/* Right column: payment methods, receipts */
.side-panel{
  display:flex;
  flex-direction:column;
  gap:12px;
}
.card{
  background:var(--card-bg);
  border-radius:var(--radius);
  padding:12px;
  box-shadow:var(--shadow);
}
.card h4{ margin:0 0 8px; font-size:14px; font-weight:700 }
.method{ display:flex; align-items:center; justify-content:space-between; gap:8px; padding:8px; border-radius:8px; background:#fbfdfe; border:1px solid rgba(15,23,42,0.03) }
.method .left{ display:flex; gap:10px; align-items:center }
.small{ font-size:13px; color:var(--muted) }

/* buttons */
.btn{ padding:8px 12px; border-radius:10px; border:0; cursor:pointer; font-weight:700 }
.btn.primary{ background:var(--brand-1); color:white }
.btn.ghost{ background:transparent; border:1px solid rgba(15,23,42,0.06) }
.ghost-sm{ padding:6px 8px; font-weight:600; border-radius:8px; }

/* receipts list */
.receipts-list{ display:flex; flex-direction:column; gap:8px; }
.receipt{ padding:10px; border-radius:8px; background:#fbfdfe; display:flex; justify-content:space-between; align-items:center }

/* mobile tweaks */
@media (max-width:480px){
  .summary{ flex-direction:column; align-items:flex-start; gap:8px }
  .invoice .meta{ font-size:12px }
  .invoice .amount{ font-size:15px }
}

/* modal (simple) */
.modal-backdrop{ position:fixed; left:0; top:0; right:0; bottom:0; background:rgba(2,6,23,0.5); display:none; align-items:center; justify-content:center; z-index:80 }
.modal{ background:white; padding:18px; border-radius:10px; width:420px; max-width:94%; box-shadow:0 20px 60px rgba(2,6,23,0.45) }
.modal h3{ margin:0 0 8px }
.row{ display:flex; gap:8px; align-items:center }
.small-muted{ font-size:13px; color:var(--muted) }
</style>
</head>
<body>

<div class="app">
  <aside class="sidebar" id="sidebar">
    <div style="padding:16px;display:flex;justify-content:center;">
      <img src="isoft.jpg" alt="ISoft Logo" style="max-height:56px;object-fit:contain">
    </div>
    <nav class="nav" aria-label="Main navigation">
      <div class="group-title">Main</div>
      <a href="StudentDashboard.html">üè† Dashboard</a>
      <a href="StudentMyCourses.html">üìö My Courses</a>
      <a href="StudentAssessmentDashboard.html">üìù Assessments</a>
      <a href="StudentTimetable">üìÖ Timetable</a>

      <div class="group-title">Admin</div>
        <a href="StudentFees.html" style="background:#60a5fa;color:#fff"">üí≥ Fees & Payments</a>
        <a href="#">üìÇ Documents</a>
        <a href="#">üí¨ Messages</a>

      <div class="group-title">CRICOS</div>
        <a href="#">üõÇ COE & Visa</a>

      <div class="group-title">Support</div>
        <a href="#">ü§ñ Ask AI</a>
        <a href="#">üìû Contact Trainer</a>

    </nav>
  </aside>

  <div class="main">
    <div class="topbar">
      <div class="profile-container" id="profile-root">
        <div id="profile-menu-button" style="display:flex;align-items:center;gap:10px;cursor:pointer;">
          <img src="owner.jpg" alt="avatar" class="profile-avatar">
          <div style="font-weight:600;color:#0f1724">John Edward</div>
          <span id="dropdown-arrow" class="material-icons">expand_more</span>
        </div>
        <div id="profile-dropdown-menu" class="hidden" aria-hidden="true">
          <div style="padding:16px;border-bottom:1px solid #e5e7eb">
            <div style="font-weight:bold;color:#1f2937">Hi, John</div>
            <div style="font-size:14px;color:#6b7280">john.edward@isoftanz.com.au</div>
          </div>
          <ul style="list-style:none;margin:0;padding:0">
            <li><a href="#" style="display:flex;align-items:center;padding:10px 16px;color:#374151">
              <span class="material-icons" style="margin-right:8px">person</span>Edit Profile</a></li>
            <li><a href="#" style="display:flex;align-items:center;padding:10px 16px;color:#374151">
              <span class="material-icons" style="margin-right:8px">settings</span>Account settings</a></li>
            <li><a href="#" style="display:flex;align-items:center;padding:10px 16px;color:#374151">
              <span class="material-icons" style="margin-right:8px">help_outline</span>Support</a></li>
            <li><a href="#" style="display:flex;align-items:center;padding:10px 16px;color:#374151;border-top:1px solid #e5e7eb;margin-top:4px">
              <span class="material-icons" style="margin-right:8px">logout</span>Sign out</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="page-header">
      <h1>Fees & Payments</h1>
      <p>Manage invoices, pay fees, view receipts and setup payment plans</p>
    </div>

    <div class="summary">
      <div class="left">
        <div class="small">Outstanding balance</div>
        <div class="balance" id="balance">$1,250.00</div>
        <div class="next-due" id="nextDue">Next due: 28 Oct ‚Äî $450</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <button class="btn primary" onclick="openPayModal()">Pay now</button>
        <button class="btn ghost" onclick="openPlan()">Set up payment plan</button>
      </div>
    </div>

    <div class="fees-grid">
      <section class="invoices" aria-labelledby="invoicesHeading">
        <h3 id="invoicesHeading">Invoices</h3>

        <div class="filter-row">
          <input id="searchInvoice" class="input" placeholder="Search invoice, code or amount">
          <select id="statusFilter" class="input">
            <option value="all">All statuses</option>
            <option value="due">Due</option>
            <option value="overdue">Overdue</option>
            <option value="paid">Paid</option>
          </select>
          <button class="ghost-sm" onclick="downloadStatements()">Export</button>
        </div>

        <div class="invoices-list" id="invoicesList" aria-live="polite">
          </div>
      </section>

      <aside class="side-panel">
        <div class="card">
          <h4>Payment methods</h4>
          <div class="method">
            <div class="left">
              <div style="width:36px;height:24px;background:linear-gradient(90deg,#374151,#6b7280);border-radius:4px"></div>
              <div>
                <div style="font-weight:700">Visa ending ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 4242</div>
                <div class="small">Expires 04/27</div>
              </div>
            </div>
            <div>
              <button class="btn ghost" onclick="manageCards()">Manage</button>
            </div>
          </div>

          <div style="height:10px"></div>
          <div class="method">
            <div class="left">
              <div style="width:36px;height:24px;background:linear-gradient(90deg,#0ea5a5,#06b6d4);border-radius:4px"></div>
              <div>
                <div style="font-weight:700">BPAY</div>
                <div class="small">Biller code available on each invoice</div>
              </div>
            </div>
            <div><button class="btn ghost" onclick="showBpay()">View</button></div>
          </div>
        </div>

        <div class="card">
          <h4>Recent receipts</h4>
          <div class="receipts-list" id="receiptsList">
            </div>
        </div>

        <div class="card">
          <h4>Quick help</h4>
          <div class="small-muted">Have a fee question? Try the AI assistant or contact finance.</div>
          <div style="margin-top:8px;display:flex;gap:8px">
            <button class="btn ghost" onclick="openChat()">Ask AI</button>
            <a href="#" class="btn primary" style="text-decoration:none" onclick="contactFinance()">Contact</a>
          </div>
        </div>
      </aside>
    </div>

    <div style="margin-top:18px;display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
      <div class="small text-muted">
        <a href="#">Help center</a> ‚Ä¢ <a href="#">Policies</a> ‚Ä¢ <a href="#">Contact support</a>
      </div>
      <div class="small text-muted">¬© 2025 iSOFT ‚Äî Student portal</div>
    </div>
  </div>
</div>

<div id="modalBackdrop" class="modal-backdrop" style="display:none;align-items:center;justify-content:center">
  <div class="modal" role="dialog" aria-modal="true">
    <h3>Pay invoice</h3>
    <div class="small-muted">Choose payment method</div>
    <div style="margin-top:12px;display:flex;flex-direction:column;gap:8px">
      <label class="method" style="padding:10px">
        <div class="left"><div style="width:36px;height:24px;background:linear-gradient(90deg,#374151,#6b7280);border-radius:4px;margin-right:8px"></div><div><div style="font-weight:700">Visa ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 4242</div><div class="small">Expires 04/27</div></div></div>
        <input type="radio" name="paymethod" value="card" checked>
      </label>

      <label class="method" style="padding:10px">
        <div class="left"><div style="width:36px;height:24px;background:linear-gradient(90deg,#0ea5a5,#06b6d4);border-radius:4px;margin-right:8px"></div><div><div style="font-weight:700">BPAY</div><div class="small">Use biller code on invoice</div></div></div>
        <input type="radio" name="paymethod" value="bpay">
      </label>

      <div style="display:flex;gap:8px;margin-top:12px;justify-content:flex-end">
        <button class="btn ghost" onclick="closeModal()">Cancel</button>
        <button class="btn primary" onclick="simulatePayment()">Pay $450</button>
      </div>
    </div>
  </div>
</div>

<div id="chatModal" style="display:none;position:fixed;right:20px;bottom:90px;width:380px;z-index:90">
  <div style="background:white;border-radius:14px;box-shadow:0 24px 60px rgba(2,6,23,0.45);overflow:hidden">
    <div style="padding:12px 14px;display:flex;justify-content:space-between;align-items:center">
      <div style="display:flex;gap:10px;align-items:center">
        <div style="width:36px;height:36px;border-radius:8px;background:linear-gradient(90deg,#06b6d4,#0f766e);display:flex;align-items:center;justify-content:center;color:white;font-weight:700">AI</div>
        <div>
          <div style="font-weight:700">AI Assistant</div>
          <div class="small text-muted">Ask about fees, COE, or payment plans</div>
        </div>
      </div>
      <div><button onclick="closeChat()" style="border:0;background:transparent;font-weight:700;cursor:pointer">‚úï</button></div>
    </div>
    <div style="height:240px;background:#f8fafc;padding:12px;overflow:auto" id="chatWindow">
      <div style="max-width:80%;padding:10px;background:white;border-radius:10px;margin-bottom:10px">Hi! I can help with payments. E.g. "Show my unpaid invoices".</div>
    </div>
    <div style="padding:10px;border-top:1px solid rgba(15,23,42,0.03);display:flex;gap:8px;align-items:center">
      <input id="chatInput" placeholder="Ask something..." style="flex:1;padding:10px;border-radius:10px;border:1px solid rgba(15,23,42,0.06)" />
      <button style="background:var(--brand-1);border:0;padding:10px 12px;border-radius:10px;color:white;cursor:pointer" onclick="sendChat()">Send</button>
    </div>
  </div>
</div>

<script>
  // Profile dropdown logic
  const profileMenuButton = document.getElementById('profile-menu-button');
  const profileDropdownMenu = document.getElementById('profile-dropdown-menu');
  const dropdownArrow = document.getElementById('dropdown-arrow');
  profileMenuButton.addEventListener('click', (e) => {
      e.stopPropagation();
      const isHidden = profileDropdownMenu.classList.toggle('hidden');
      profileDropdownMenu.setAttribute('aria-hidden', isHidden ? 'true' : 'false');
      dropdownArrow.style.transform = isHidden ? 'rotate(0deg)' : 'rotate(180deg)';
  });
  window.addEventListener('click', (event) => {
      if (!profileMenuButton.contains(event.target) && !profileDropdownMenu.contains(event.target)) {
          profileDropdownMenu.classList.add('hidden');
          profileDropdownMenu.setAttribute('aria-hidden','true');
          dropdownArrow.style.transform = 'rotate(0deg)';
      }
  });

  // Sample invoice and receipt data (matches your course examples)
  const invoices = [
    { id: 101, code:'INV-2025-101', course:'Diploma of Business', due:'2025-10-28', amount:450.00, status:'due', notes:'Tuition instalment 2', cricos:false },
    { id: 102, code:'INV-2025-102', course:'Certificate IV in IT', due:'2025-10-22', amount:320.00, status:'paid', notes:'Tuition instalment 1', cricos:false },
    { id: 103, code:'INV-2025-103', course:'Advanced Diploma of Leadership (CRICOS)', due:'2025-11-01', amount:480.00, status:'overdue', notes:'Tuition instalment 3', cricos:true },
    { id: 104, code:'INV-2025-104', course:'Diploma of Business', due:'2025-09-15', amount:0.00, status:'paid', notes:'Material fees', cricos:false },
  ];
  const receipts = [
    { id: 'RCPT-2001', date:'2025-09-16', amount:1200.00 },
    { id: 'RCPT-2002', date:'2025-10-02', amount:320.00 },
  ];

  // DOM refs
  const invoicesList = document.getElementById('invoicesList');
  const receiptsList = document.getElementById('receiptsList');
  const balanceEl = document.getElementById('balance');
  const nextDueEl = document.getElementById('nextDue');

  // compute outstanding
  function computeBalance(){
    const outstanding = invoices.filter(i => i.status === 'due' || i.status === 'overdue').reduce((s,i)=>s+i.amount,0);
    balanceEl.textContent = `$${outstanding.toFixed(2)}`;
    const nextDue = invoices.filter(i => i.status === 'due' || i.status === 'overdue')
                          .sort((a,b)=> new Date(a.due)-new Date(b.due))[0];
    if(nextDue) nextDueEl.textContent = `Next due: ${nextDue.due} ‚Äî $${nextDue.amount.toFixed(2)}`;
    else nextDueEl.textContent = 'No upcoming payments';
  }

  // render invoices
  function renderInvoices(filter='all', q=''){
    invoicesList.innerHTML = '';
    const items = invoices.filter(i => {
      if(filter==='all') return true;
      return i.status === filter;
    }).filter(i => {
      if(!q) return true;
      return `${i.code} ${i.course} ${i.notes}`.toLowerCase().includes(q.toLowerCase());
    });

    if(items.length===0){
      invoicesList.innerHTML = '<div class="small" style="padding:12px;text-align:center;color:var(--muted)">No invoices</div>';
      return;
    }

    items.forEach(inv=>{
      const div = document.createElement('div');
      div.className = 'invoice ' + (inv.status==='overdue'?'overdue':inv.status==='due'?'due':'paid');
      div.innerHTML = `
        <div style="flex:1">
          <div style="display:flex;justify-content:space-between;gap:12px;align-items:center">
            <div>
              <div style="font-weight:700">${inv.course}</div>
              <div class="meta">${inv.code} ‚Ä¢ ${inv.notes}</div>
            </div>
            <div style="text-align:right">
              <div class="amount">$${inv.amount.toFixed(2)}</div>
              <div class="meta">Due ${inv.due}</div>
            </div>
          </div>
        </div>
        <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end;margin-left:12px">
          ${inv.status !== 'paid' ? `<button class="btn primary" onclick="payInvoice(${inv.id})">Pay</button>` : `<button class="btn ghost" onclick="downloadReceipt('${inv.code}')">Receipt</button>`}
          <button class="btn ghost" onclick="viewInvoice(${inv.id})">Details</button>
        </div>
      `;
      invoicesList.appendChild(div);
    });
  }

  // render receipts
  function renderReceipts(){
    receiptsList.innerHTML = '';
    receipts.forEach(r=>{
      const d = document.createElement('div');
      d.className = 'receipt';
      d.innerHTML = `<div>
        <div style="font-weight:700">${r.id}</div>
        <div class="small">${r.date}</div>
      </div>
      <div style="text-align:right">
        <div style="font-weight:700">$${r.amount.toFixed(2)}</div>
        <button class="btn ghost" onclick="downloadReceipt('${r.id}')">Download</button>
      </div>`;
      receiptsList.appendChild(d);
    });
  }

  // initial load
  computeBalance();
  renderInvoices('all','');
  renderReceipts();

  // search & filter
  document.getElementById('searchInvoice').addEventListener('input',(e)=>{
    renderInvoices(document.getElementById('statusFilter').value, e.target.value);
  });
  document.getElementById('statusFilter').addEventListener('change',(e)=>{
    renderInvoices(e.target.value, document.getElementById('searchInvoice').value);
  });

  // actions
  function payInvoice(id){
    // select invoice amount in modal (simple demo - in real app preselect invoice)
    const inv = invoices.find(x=>x.id===id);
    if(!inv) return alert('Invoice not found');
    // open modal and show amount in button
    document.querySelector('#modalBackdrop .modal button.primary').textContent = `Pay $${inv.amount.toFixed(2)}`;
    document.getElementById('modalBackdrop').style.display = 'flex';
  }
  function openPayModal(){ document.getElementById('modalBackdrop').style.display = 'flex'; }
  function closeModal(){ document.getElementById('modalBackdrop').style.display = 'none'; }
  function simulatePayment(){
    // demo: mark first due invoice as paid
    const due = invoices.find(i => i.status === 'due' || i.status === 'overdue');
    if(due){ due.status = 'paid'; receipts.unshift({id:'RCPT-'+(2000+receipts.length+1), date: new Date().toISOString().slice(0,10), amount: due.amount}); }
    closeModal();
    computeBalance(); renderInvoices('all',document.getElementById('searchInvoice').value); renderReceipts();
    alert('Payment simulated ‚Äî receipt generated (demo).');
  }
  function openPlan(){ alert('Open Setup Payment Plan flow ‚Äî wire to backend'); }
  function manageCards(){ alert('Open card management'); }
  function showBpay(){ alert('Show BPAY information on invoice detail'); }
  function downloadReceipt(id){ alert('Download receipt/invoice: ' + id + ' (demo)'); }
  function viewInvoice(id){ const inv = invoices.find(x=>x.id===id); alert(JSON.stringify(inv,null,2)); }
  function downloadStatements(){ alert('Export statements CSV (demo)'); }

  // quick actions
  function contactFinance(){ alert('Contact finance ‚Äî open support flow'); }
  function openChat(){ document.getElementById('chatModal').style.display='block' }
  function closeChat(){ document.getElementById('chatModal').style.display='none' }
  function sendChat(){ const v = document.getElementById('chatInput').value.trim(); if(!v) return; const w = document.getElementById('chatWindow'); const el = document.createElement('div'); el.style.cssText='max-width:80%;padding:10px;background:#eff6ff;border-radius:10px;margin-bottom:10px;margin-left:auto'; el.textContent = v; w.appendChild(el); document.getElementById('chatInput').value=''; w.scrollTop = w.scrollHeight; }

</script>
</body>

</html>
